import React, { useState, useEffect } from 'react';

// Pagination page component
export default function Pagination ({ onChangeCurrentPage, onChangeIsReload, currentPage, totalPages }) {
	
	// This pagination button will handle page number also will set state for page and loading animation
	// Page number counting for pagination
	let itemsPerPage = 60;
	const buttonsPerPage = 5;
	const pageNumbers = [];
	for (let i = 1; i <= Math.ceil(totalPages); i++) {
		pageNumbers.push(i);
	}
	const startButtonIndex = Math.floor((currentPage - 1) / buttonsPerPage) * buttonsPerPage;
	const endButtonIndex = startButtonIndex + buttonsPerPage;
	const visiblePageNumbers = pageNumbers.slice(startButtonIndex, endButtonIndex);
	
	const handleFirstPage = () => {
		onChangeIsReload(true);
		onChangeCurrentPage(1);
	};
	const handleLastPage = () => {
		onChangeIsReload(true);
		onChangeCurrentPage(totalPages);
	};
	const handleClick = (pageNumber) => {
		onChangeIsReload(true);
		onChangeCurrentPage(pageNumber);
	};
	const handleNextPage = () => {
		onChangeIsReload(true);
		onChangeCurrentPage((prevPage) => prevPage + 1)
	};
	const handlePrevPage = () => {
		onChangeIsReload(true);
		onChangeCurrentPage((prevPage) => prevPage - 1);
	};
	
	return (
		<>
			<div className="heading center-flex">
				<div className="pagination">
					<button className="number" onClick={handleFirstPage} disabled={currentPage === 1}>First</button>
					<button className="number" onClick={handlePrevPage} disabled={currentPage === 1}>
						<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="24" viewBox="0 -960 960 960" width="24"><path d="M560-253.847 333.847-480 560-706.153 602.153-664l-184 184 184 184L560-253.847Z"/></svg>
					</button>
					{visiblePageNumbers.map((pageNumber) => (
					<button className="number"
					  key={pageNumber}
					  onClick={() => handleClick(pageNumber)}
					  disabled={currentPage === pageNumber}>
					  {pageNumber}
					</button>
					))}
					<button className="number" onClick={handleNextPage} disabled={currentPage === totalPages || totalPages === 0}>
						<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="24" viewBox="0 -960 960 960" width="24"><path d="m517.847-480-184-184L376-706.153 602.153-480 376-253.847 333.847-296l184-184Z"/></svg>
					</button>
					<button className="number" onClick={handleLastPage} disabled={currentPage === totalPages || totalPages === 0}>Last</button>
				</div>
			</div>
		</>
	);
};